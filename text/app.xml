<?xml version="1.0" encoding="UTF-8"?>
<script xmlns="http://www.xstep.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <variables>
        <variable type="execution-file" name="execute"
            >file:///C:/Users/bruening.FDH-FFM/txstep/ueb/txstep.tu</variable>
        <variable type="permanent-file" name="app1" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1.tf</variable>
        <!--<variable type="permanent-file" name="app1head" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1head.tf</variable>
        <variable type="permanent-file" name="app1trail" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1trail.tf</variable>-->
        <variable type="permanent-file" name="app1fn" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1fn.tf</variable>
        <variable type="permanent-file" name="app1p" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1p.tf</variable>
        <!--<variable type="permanent-file" name="app1t1a" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t1a.tf</variable>
        <variable type="permanent-file" name="app1t1b" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t1b.tf</variable>
        <variable type="permanent-file" name="app1t1b0" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t1b0.tf</variable>
        <variable type="permanent-file" name="app1t1c" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t1c.tf</variable>
        <variable type="permanent-file" name="app1t1c0" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t1c0.tf</variable>
        <variable type="permanent-file" name="app1t2a" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2a.tf</variable>
        <variable type="permanent-file" name="app1t2a0" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2a0.tf</variable>
        <variable type="permanent-file" name="app1t2aa" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2aa.tf</variable>
        <variable type="permanent-file" name="app1t2aa0" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2aa0.tf</variable>
        <variable type="permanent-file" name="app1t2b" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2b.tf</variable>
        <variable type="permanent-file" name="app1t2b0" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2b0.tf</variable>
        <variable type="permanent-file" name="app1t2c" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2c.tf</variable>
        <variable type="permanent-file" name="app1t2c0" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2c0.tf</variable>
        <variable type="permanent-file" name="app1t2d" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t2d.tf</variable>
        <variable type="permanent-file" name="app1t3" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t3.tf</variable>
        <variable type="permanent-file" name="app1t4a" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t4b.tf</variable>
        <variable type="permanent-file" name="app1t4b" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t4b.tf</variable>
        <variable type="permanent-file" name="app1t5" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t5.tf</variable>
        <variable type="permanent-file" name="app1t6" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t6.tf</variable>
        <variable type="permanent-file" name="app1t7" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t7.tf</variable>
        <variable type="permanent-file" name="app1t8" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1t8.tf</variable>
        <variable type="permanent-file" name="app1tq" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1tq.tf</variable>-->
        <variable type="permanent-file" name="app1sort" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1sort.tf</variable>
        <variable type="permanent-file" name="app1clean" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1clean.tf</variable>
        <variable type="permanent-file" name="app1sort-rtf" option="erase" format="system"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app1sort.rtf</variable>
        <variable type="permanent-file" name="app2" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app2.tf</variable>
        <variable type="permanent-file" name="app2sort" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app2sort.tf</variable>
        <variable type="permanent-file" name="app2clean" option="erase"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app2clean.tf</variable>
        <variable type="permanent-file" name="app2sort-rtf" option="erase" format="system"
            >file:///C:/Users/bruening.FDH-FFM/txstep/txt/app2sort.rtf</variable>
        <variable type="scratch-file" name="head"/>
        <variable type="scratch-file" name="typ1a"/>
        <variable type="scratch-file" name="trail"/>
        <variable type="scratch-file" name="cleanup"/>
    </variables>
    <tustep>
#de,da=*
app1rtf = C:\users\bruening.FDH-FFM\txstep\txt\app1.rtf
*eof
#anmelde, app1rtf, traeger = -
#*import, app1rtf, app1, ignor = -
    </tustep>
    <transform source="app1" destination="app1fn">
        <new-line-before>
            <search-table>
                <search-string>{{en}}</search-string>
                <search-string>{{fn}}</search-string>
            </search-table>
        </new-line-before>
        <new-line-after>
            <search-table>
                <search-string>{{/en}}</search-string>
                <search-string>{{/fn}}</search-string>
            </search-table>
        </new-line-after>
    </transform>
    <transform source="app1fn" destination="app1p">
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>{{en</search-string>
                            <search-string>{{fn</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{{fn*</search-string>
                            <replacement-string>{{p}}{=1=}{{/p}}</replacement-string>
                        </string-pair>
                        <string-pair>
                            <search-string>{{en*</search-string>
                            <replacement-string>{{p}}{=1=}{{/p}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{{{0}/en}}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{{{0}/fn}}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{{{0}/en-p*}}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{{{0}/fn-p*}}</search-string>
                            <replacement-string/>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
    </transform>
    <!-- build app1sort -->
    <transform source="app1" destination="app1sort" save-params="head">
        <define-text-units>
            <text-unit-start>
                <comparison-table>
                    <exclusion-string>{{head}}</exclusion-string>
                    <exclusion-string>{{dstyle</exclusion-string>
                    <exclusion-string>{{pstyle</exclusion-string>
                    <exclusion-string>{{cstyle</exclusion-string>
                    <exclusion-string>{{/head}}</exclusion-string>
                    <exclusion-string>{{body</exclusion-string>
                    <exclusion-string>{{section</exclusion-string>
                    <comparison-string>{{document</comparison-string>
                    <comparison-string>{{p</comparison-string>
                    <!-- p, sonst Fehlerhalt -->
                </comparison-table>
            </text-unit-start>
        </define-text-units>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>{{document</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>font="Calibri"</search-string>
                            <replacement-string>font="Times"</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <new-line-before>
            <search-table>
                <search-string>{{head</search-string>
                <search-string>{{dstyle</search-string>
                <search-string>{{pstyle</search-string>
                <search-string>{{cstyle</search-string>
                <search-string>{{/head</search-string>
                <search-string>{{body</search-string>
                <search-string>{{section</search-string>
            </search-table>
        </new-line-before>
    </transform>
    <transform source="app1p" destination="app1sort" option="append" save-params="typ1a">
        <insert-at-start>{{p}}{{font size="12"}}Typ 1a{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>typ {0}n1\a</search-string>
                            <search-string>(1\a</search-string>
                            <search-string>bzw. 1\a</search-string>
                            <search-string>oder 1\a</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 1b{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <exception-string>\[typ 1b#\[2310\]\]</exception-string>
                            <exception-string>1b0</exception-string>
                            <search-string>1\b</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 1b#[2310]{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>1b#\[2310\]</search-string>
                            <search-string>1b0</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 1c{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <exception-string>\[typ 1c#\[2310\]\]</exception-string>
                            <exception-string>1c0</exception-string>
                            <search-string>typ 1\c</search-string>
                            <search-string>1\c oder 1c#\[2310\]</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 1c#[2310]{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>1c#\[2310\]</search-string>
                            <search-string>1c0</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2a{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <exception-string>2a#\[2310\]</exception-string>
                            <exception-string>2\a0</exception-string>
                            <exception-string>2\a\a</exception-string>
                            <search-string>2\a</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2a#[2310]{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>2a#\[2310\]</search-string>
                            <search-string>2\a0</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2aa{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <exception-string>2aa#\[2310\]</exception-string>
                            <search-string>2\a\a</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2aa#[2310]{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>2aa#\[2310\]</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2b{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <exception-string>2b#\[2310\]</exception-string>
                            <exception-string>2\b0</exception-string>
                            <search-string>2\b</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2b#[2310]{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>2b#\[2310\]</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2c{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <exception-string>2c#\[2310\]</exception-string>
                            <search-string>2c</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2c#[2310]{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>2c#\[2310\]</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 2d (immer 2d#[2310]){{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>2d#\[2310\]</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 3 (immer 3#[2310]){{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>typ 3</search-string>
                            <search-string>oder 3</search-string>
                            <search-string>bzw. 3</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 4a{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>4\a</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 4b{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>4\b</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 5{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>typ 5</search-string>
                            <search-string>oder 5</search-string>
                            <search-string>bzw. 5</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 6{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>typ 6</search-string>
                            <search-string>oder 6</search-string>
                            <search-string>bzw. 6</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 7{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>typ 7</search-string>
                            <search-string>oder 7</search-string>
                            <search-string>bzw. 7</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ 8{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>typ 8</search-string>
                            <search-string>oder 8</search-string>
                            <search-string>bzw. 8</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Typ: ?{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>typ: \?</search-string>
                            <search-string>typ:_\?</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1p" destination="app1sort" option="append">
        <insert-at-start>{{p}}{{font size="12"}}Diskussionsbedürftig{{/font}}{{/p}}</insert-at-start>
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>++</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
        <insert-at-end>{{p after="0" line-feed="12"/}}</insert-at-end>
    </transform>
    <transform source="app1" destination="app1sort" option="append" save-params="trail">
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>{{/section}}</search-string>
                            <search-string>{{/body}}</search-string>
                            <search-string>{{/document}}</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
    </transform>
    <transform source="app1sort" destination="app1clean" save-params="cleanup">
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>^+</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>name="Times"}}{|}*\[*\]\{*\}</search-string>
                            <replacement-string>{=1=}</replacement-string>
                        </string-pair>
                        <string-pair>
                            <search-string>left="8"}}{|}*\[*\]\{*\}</search-string>
                            <replacement-string>{=1=}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
    </transform>
    <tustep>
#*export, app1clean, app1sort-rtf, loeschen = +        
#de,da=*
app2rtf = C:\users\bruening.FDH-FFM\txstep\txt\app2.rtf
*eof
#anmelde, app2rtf, traeger = -
#*import, app2rtf, app2, ignor = -
    </tustep>
    <!-- build app2 -->
    <transform source="app2" destination="app2sort" take-params="head"/>
    <transform source="app2" destination="app2sort" take-params="typ1a" option="append"/>
    <transform source="app2" destination="app2sort" take-params="trail" option="append"/>
    <tustep>
#*export, app2sort, app2sort-rtf, loeschen = +        
    </tustep>
</script>
